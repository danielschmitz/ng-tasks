import{a as z}from"./chunk-BQZABLY7.js";import{d as A}from"./chunk-WF2BA3OG.js";import{l as D,m as R,n as U,w as j}from"./chunk-FAZAPXBE.js";import{a as B}from"./chunk-7NHJSWUD.js";import"./chunk-MW6LRQ77.js";import"./chunk-WWOF3X5T.js";import{b as N,d as _,f as M,g as T,i as q,k,l as V,n as O,u as G,v as P,z as $}from"./chunk-45AOXZM7.js";import"./chunk-63ELC5ES.js";import"./chunk-EZTHPUAS.js";import{ca as F}from"./chunk-3RQUDV4Z.js";import"./chunk-HU7WFQWJ.js";import{Db as p,Ec as L,Gc as I,Ib as o,Jb as n,Kb as g,Ob as h,Rb as b,Tb as d,ab as l,cc as r,dc as w,ec as y,fa as f,ic as v,jc as S,mb as E,na as C,oa as x,sb as u,yb as c}from"./chunk-T4MBMAI6.js";function W(t,a){if(t&1){let e=h();o(0,"p"),r(1," Hi "),o(2,"b"),r(3),v(4,"async"),n()(),o(5,"p")(6,"a",1),r(7,"Go to dashboard"),n()(),o(8,"p")(9,"button",2),b("click",function(){C(e);let s=d();return x(s.logout())}),r(10,"Logout"),n()()}if(t&2){let e,i=d();l(3),w((e=S(4,1,i.user$))==null?null:e.name)}}function J(t,a){t&1&&r(0," Email is required. ")}function K(t,a){t&1&&r(0," Invalid email format. ")}function Q(t,a){if(t&1&&(o(0,"mat-error"),u(1,J,1,0)(2,K,1,0),n()),t&2){let e,i,s=d(2);l(),p(!((e=s.form.get("email"))==null||e.errors==null)&&e.errors.required?1:-1),l(),p(!((i=s.form.get("email"))==null||i.errors==null)&&i.errors.email?2:-1)}}function X(t,a){t&1&&(o(0,"mat-error"),r(1," Password is required. "),n())}function Y(t,a){t&1&&(o(0,"mat-error"),r(1," Name is required when creating an account. "),n())}function Z(t,a){if(t&1&&(o(0,"mat-form-field",5)(1,"mat-label"),r(2,"Name"),n(),g(3,"input",12),u(4,Y,2,0,"mat-error",7),n()),t&2){let e,i=d(2);l(4),c("ngIf",((e=i.form.get("name"))==null?null:e.hasError("required"))&&((e=i.form.get("name"))==null?null:e.touched))}}function ee(t,a){if(t&1){let e=h();o(0,"form",3),b("ngSubmit",function(){C(e);let s=d();return x(s.onSubmit())}),o(1,"app-loading",4)(2,"mat-form-field",5)(3,"mat-label"),r(4,"Email"),n(),g(5,"input",6),u(6,Q,3,2,"mat-error",7),n(),o(7,"mat-form-field",5)(8,"mat-label"),r(9,"Password"),n(),g(10,"input",8),u(11,X,2,0,"mat-error",7),n(),o(12,"mat-slide-toggle",9),r(13,"Create Account"),n(),u(14,Z,5,1,"mat-form-field",5),n(),o(15,"div",10)(16,"button",11),r(17),n()()()}if(t&2){let e,i,s,m=d();c("formGroup",m.form),l(),c("loading",m.loading),l(5),c("ngIf",((e=m.form.get("email"))==null?null:e.invalid)&&((e=m.form.get("email"))==null?null:e.touched)),l(5),c("ngIf",((i=m.form.get("password"))==null?null:i.invalid)&&((i=m.form.get("password"))==null?null:i.touched)),l(3),p((s=m.form.get("createAccount"))!=null&&s.value?14:-1),l(2),c("disabled",m.form.invalid||m.loading),l(),y(" ",m.loading?"Wait...":"Submit"," ")}}var H=class t{auth=f(z);snak=f(D);fb=f(O);loading=!1;form;loggedIn$=this.auth.loginState$;user$=this.auth.userState$;constructor(){this.form=this.fb.group({email:["",[_.required,_.email]],password:["",_.required],createAccount:[!1],name:[""]},{validators:this.nameRequiredIfCreatingAccount})}ngOnInit(){this.form.setValue({email:"user1@email.com",password:"123456",createAccount:!1,name:"User 1"})}onSubmit(){if(this.form.valid){let a=this.form.get("createAccount")?.value;this.loading=!0,this.auth.login(this.form.get("email")?.value,this.form.get("password")?.value,a?this.form.get("name")?.value:null).subscribe({next:e=>{this.loading=!1,console.log({user:e}),this.snak.open("Login realizado com sucesso")},error:e=>{this.loading=!1,console.error("deu erro",e),this.snak.open(e.error.message)}})}}logout(){this.auth.logout(),this.snak.open("Logout realizado com sucesso")}nameRequiredIfCreatingAccount(a){let e=a.get("createAccount")?.value,i=a.get("name");return e&&!i?.value?(i?.setErrors({required:!0}),{nameRequired:!0}):(i?.setErrors(null),null)}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=E({type:t,selectors:[["app-login"]],decls:5,vars:3,consts:[[3,"formGroup"],["routerLink","/dashboard"],["mat-flat-button","",3,"click"],[3,"ngSubmit","formGroup"],[3,"loading"],["appearance","fill"],["matInput","","id","email","type","email","formControlName","email","placeholder","Enter your email"],[4,"ngIf"],["matInput","","id","password","type","password","formControlName","password","placeholder","Enter your password"],["formControlName","createAccount"],[1,"actions"],["mat-flat-button","","type","submit",3,"disabled"],["matInput","","id","name","formControlName","name","placeholder","Enter your name"]],template:function(e,i){e&1&&(o(0,"h2"),r(1,"Login"),n(),u(2,W,11,3),v(3,"async"),u(4,ee,18,7,"form",0)),e&2&&(l(2),p(S(3,1,i.loggedIn$)?2:4))},dependencies:[j,L,q,N,M,T,k,V,F,A,$,G,P,B,R,U,I],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}form[_ngcontent-%COMP%]{padding:2rem;border-radius:1rem;max-width:400px;width:100%;display:flex;flex-direction:column;gap:.8rem}mat-form-field[_ngcontent-%COMP%]{width:100%}"]})};export{H as LoginComponent};
