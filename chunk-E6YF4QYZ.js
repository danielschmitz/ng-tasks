import{a as le}from"./chunk-MOUQTJNW.js";import{d as H}from"./chunk-WF2BA3OG.js";import{l as N,n as z,p as te,q as ie,r as ae,s as oe,t as ne,u as re,v as y}from"./chunk-VYZYZZJW.js";import{a as S,b as B,c as j,d as G,e as J,f as K,g as U,h as W,i as X,j as Y,l as Z,o as w,q as v,r as ee}from"./chunk-WWOF3X5T.js";import{a as q}from"./chunk-7NHJSWUD.js";import{u as Q,z as $}from"./chunk-45AOXZM7.js";import{g as P}from"./chunk-EZTHPUAS.js";import"./chunk-MW6LRQ77.js";import"./chunk-63ELC5ES.js";import{ca as b,da as O}from"./chunk-3RQUDV4Z.js";import"./chunk-HU7WFQWJ.js";import{Ib as a,Jb as o,Kb as s,L as V,Lb as f,Mb as u,Ob as I,Rb as d,Tb as A,Wb as L,Yb as h,Zb as D,_b as M,ab as m,bb as x,cc as r,dc as g,fa as C,hc as F,mb as _,na as T,oa as k,sb as c,yb as p}from"./chunk-T4MBMAI6.js";var E=class e{constructor(t,i){this.dialogRef=t;this.data=i}onConfirm(){this.dialogRef.close(!0)}onCancel(){this.dialogRef.close(!1)}static \u0275fac=function(i){return new(i||e)(x(te),x(ie))};static \u0275cmp=_({type:e,selectors:[["app-confirm-dialog"]],decls:10,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions","","align","end"],["mat-button","",3,"click"],["mat-flat-button","","color","primary",3,"click"]],template:function(i,n){i&1&&(a(0,"h2",0),r(1,"Confirm"),o(),a(2,"div",1)(3,"p"),r(4),o()(),a(5,"div",2)(6,"button",3),d("click",function(){return n.onCancel()}),r(7,"Cancel"),o(),a(8,"button",4),d("click",function(){return n.onConfirm()}),r(9,"Ok"),o()()),i&2&&(m(4),g(n.data.question))},dependencies:[y,b,oe,re,ne],encapsulation:2})};var fe=()=>[5,10,20];function ue(e,t){e&1&&(a(0,"th",18),r(1,"Id"),o())}function ge(e,t){if(e&1&&(a(0,"td",19),r(1),o()),e&2){let i=t.$implicit;m(),g(i.id)}}function Ce(e,t){e&1&&(a(0,"th",18),r(1,"Name"),o())}function _e(e,t){if(e&1&&(a(0,"td",20),r(1),o()),e&2){let i=t.$implicit;m(),g(i.name)}}function he(e,t){e&1&&s(0,"th",18)}function De(e,t){if(e&1&&(a(0,"td",21)(1,"button",22)(2,"mat-icon"),r(3,"edit"),o()()()),e&2){let i=t.$implicit;m(),L("routerLink","/categories/edit/",i.id,"")}}function Me(e,t){e&1&&s(0,"th",18)}function be(e,t){if(e&1){let i=I();a(0,"td",21)(1,"button",23),d("click",function(){let l=T(i).$implicit,R=A();return k(R.onDeleteClick(l.id))}),a(2,"mat-icon"),r(3,"delete"),o()()()}}function Se(e,t){e&1&&s(0,"tr",24)}function we(e,t){e&1&&s(0,"tr",25)}var me=class e{service=C(le);snak=C(N);dialog=C(ae);categories$=this.service.getAll();categories=[];loading=!1;displayedColumns=["id","name","actionEdit","actionDelete"];paginator;sort;table;dataSource=new Z([]);ngOnInit(){this.fetchCategories()}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator}fetchCategories(){this.loading=!0,this.categories$.subscribe({next:t=>{this.dataSource.data=t,this.loading=!1},error:()=>{this.loading=!1,this.snak.open("Error loading categories")}})}onDeleteClick(t){let i=this.dialog.open(E,{data:{question:"Delete this category?"}}).afterClosed().subscribe(n=>{n&&(this.loading=!0,this.service.delete(t).pipe(V(()=>this.loading=!1)).subscribe({next:()=>{this.categories$=this.service.getAll(),this.fetchCategories()},error:l=>{this.snak.open(l.message.message)}}))})}applyFilter(t){let i=t.target.value;this.dataSource.filter=i.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=_({type:e,selectors:[["app-categories"]],viewQuery:function(i,n){if(i&1&&(h(w,5),h(v,5),h(S,5)),i&2){let l;D(l=M())&&(n.paginator=l.first),D(l=M())&&(n.sort=l.first),D(l=M())&&(n.table=l.first)}},decls:28,vars:7,consts:[["input",""],[1,"toolbar"],[1,"spacer"],["mat-flat-button","","routerLink","/categories/new"],["matInput","",3,"keyup"],[3,"loading"],["mat-table","","matSort","","aria-label","Elements",1,"full-width-table",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-cell","","width","100%",4,"matCellDef"],["matColumnDef","actionEdit"],["mat-cell","","class","noMarginPadding",4,"matCellDef"],["matColumnDef","actionDelete"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSize","pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-cell","","width","100%"],["mat-cell","",1,"noMarginPadding"],["mat-icon-button","","aria-label","Edit",3,"routerLink"],["mat-icon-button","","aria-label","Edit",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(i,n){if(i&1){let l=I();a(0,"div",1)(1,"h2"),r(2,"Categories"),o(),s(3,"div",2),a(4,"button",3),r(5,"New"),o()(),a(6,"mat-form-field")(7,"mat-label"),r(8,"Filter"),o(),a(9,"input",4,0),d("keyup",function(se){return T(l),k(n.applyFilter(se))}),o()(),a(11,"app-loading",5)(12,"table",6),f(13,7),c(14,ue,2,0,"th",8)(15,ge,2,1,"td",9),u(),f(16,10),c(17,Ce,2,0,"th",8)(18,_e,2,1,"td",11),u(),f(19,12),c(20,he,1,0,"th",8)(21,De,4,2,"td",13),u(),f(22,14),c(23,Me,1,0,"th",8)(24,be,4,0,"td",13),u(),c(25,Se,1,0,"tr",15)(26,we,1,0,"tr",16),o(),s(27,"mat-paginator",17),o()}i&2&&(m(11),p("loading",n.loading),m(),p("dataSource",n.dataSource),m(13),p("matHeaderRowDef",n.displayedColumns),m(),p("matRowDefColumns",n.displayedColumns),m(),p("pageSize",5)("pageSizeOptions",F(6,fe)))},dependencies:[y,b,O,P,H,$,Q,q,z,S,j,U,G,B,W,J,K,X,Y,w,v,ee],encapsulation:2})};export{me as CategoriesComponent};
