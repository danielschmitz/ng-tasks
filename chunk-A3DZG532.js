import{a as ee}from"./chunk-AMGKBR67.js";import{a as te}from"./chunk-3UBSA5XU.js";import"./chunk-VCR3DY3D.js";import{d as V}from"./chunk-WF2BA3OG.js";import{l as $,n as z,r as Y,w as Z}from"./chunk-FAZAPXBE.js";import{a as P}from"./chunk-7NHJSWUD.js";import"./chunk-MW6LRQ77.js";import{a as _,b as A,c as q,d as B,e as N,f as j,g as G,h as J,i as K,j as U,l as W,o as w,q as S,r as X}from"./chunk-WWOF3X5T.js";import{u as Q,z as O}from"./chunk-45AOXZM7.js";import"./chunk-63ELC5ES.js";import{g as F}from"./chunk-EZTHPUAS.js";import{ca as H,da as L}from"./chunk-3RQUDV4Z.js";import"./chunk-HU7WFQWJ.js";import{Ib as a,Jb as o,Kb as s,L as x,Lb as c,Mb as f,Ob as M,Rb as D,Tb as k,Wb as I,Yb as g,Zb as C,_b as h,ab as m,cc as l,dc as v,fa as u,hc as R,mb as T,na as b,oa as y,sb as p,yb as d}from"./chunk-T4MBMAI6.js";var oe=()=>[5,10,20];function ne(e,t){e&1&&(a(0,"th",18),l(1,"Id"),o())}function re(e,t){if(e&1&&(a(0,"td",19),l(1),o()),e&2){let i=t.$implicit;m(),v(i.id)}}function le(e,t){e&1&&(a(0,"th",18),l(1,"Name"),o())}function me(e,t){if(e&1&&(a(0,"td",20),l(1),o()),e&2){let i=t.$implicit;m(),v(i.name)}}function se(e,t){e&1&&s(0,"th",18)}function pe(e,t){if(e&1&&(a(0,"td",21)(1,"button",22)(2,"mat-icon"),l(3,"edit"),o()()()),e&2){let i=t.$implicit;m(),I("routerLink","/categories/edit/",i.id,"")}}function de(e,t){e&1&&s(0,"th",18)}function ce(e,t){if(e&1){let i=M();a(0,"td",21)(1,"button",23),D("click",function(){let r=b(i).$implicit,E=k();return y(E.onDeleteClick(r.id))}),a(2,"mat-icon"),l(3,"delete"),o()()()}}function fe(e,t){e&1&&s(0,"tr",24)}function ue(e,t){e&1&&s(0,"tr",25)}var ie=class e{service=u(ee);snak=u($);dialog=u(Y);categories$=this.service.getAll();categories=[];loading=!1;displayedColumns=["id","name","actionEdit","actionDelete"];paginator;sort;table;dataSource=new W([]);ngOnInit(){this.fetchCategories()}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator}fetchCategories(){this.loading=!0,this.categories$.subscribe({next:t=>{this.dataSource.data=t,this.loading=!1},error:()=>{this.loading=!1,this.snak.open("Error loading categories")}})}onDeleteClick(t){let i=this.dialog.open(te,{data:{question:"Delete this category?"}}).afterClosed().subscribe(n=>{n&&(this.loading=!0,this.service.delete(t).pipe(x(()=>this.loading=!1)).subscribe({next:()=>{this.categories$=this.service.getAll(),this.fetchCategories()},error:r=>{this.snak.open(r.message.message)}}))})}applyFilter(t){let i=t.target.value;this.dataSource.filter=i.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=T({type:e,selectors:[["app-categories"]],viewQuery:function(i,n){if(i&1&&(g(w,5),g(S,5),g(_,5)),i&2){let r;C(r=h())&&(n.paginator=r.first),C(r=h())&&(n.sort=r.first),C(r=h())&&(n.table=r.first)}},decls:28,vars:7,consts:[["input",""],[1,"toolbar"],[1,"spacer"],["mat-flat-button","","routerLink","/categories/new"],["matInput","",3,"keyup"],[3,"loading"],["mat-table","","matSort","","aria-label","Elements",1,"full-width-table",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-cell","","width","100%",4,"matCellDef"],["matColumnDef","actionEdit"],["mat-cell","","class","noMarginPadding",4,"matCellDef"],["matColumnDef","actionDelete"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSize","pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-cell","","width","100%"],["mat-cell","",1,"noMarginPadding"],["mat-icon-button","","aria-label","Edit",3,"routerLink"],["mat-icon-button","","aria-label","Edit",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(i,n){if(i&1){let r=M();a(0,"div",1)(1,"h2"),l(2,"Categories"),o(),s(3,"div",2),a(4,"button",3),l(5,"New"),o()(),a(6,"mat-form-field")(7,"mat-label"),l(8,"Filter"),o(),a(9,"input",4,0),D("keyup",function(ae){return b(r),y(n.applyFilter(ae))}),o()(),a(11,"app-loading",5)(12,"table",6),c(13,7),p(14,ne,2,0,"th",8)(15,re,2,1,"td",9),f(),c(16,10),p(17,le,2,0,"th",8)(18,me,2,1,"td",11),f(),c(19,12),p(20,se,1,0,"th",8)(21,pe,4,2,"td",13),f(),c(22,14),p(23,de,1,0,"th",8)(24,ce,4,0,"td",13),f(),p(25,fe,1,0,"tr",15)(26,ue,1,0,"tr",16),o(),s(27,"mat-paginator",17),o()}i&2&&(m(11),d("loading",n.loading),m(),d("dataSource",n.dataSource),m(13),d("matHeaderRowDef",n.displayedColumns),m(),d("matRowDefColumns",n.displayedColumns),m(),d("pageSize",5)("pageSizeOptions",R(6,oe)))},dependencies:[Z,H,L,F,V,O,Q,P,z,_,q,G,B,A,J,N,j,K,U,w,S,X],encapsulation:2})};export{ie as CategoriesComponent};
